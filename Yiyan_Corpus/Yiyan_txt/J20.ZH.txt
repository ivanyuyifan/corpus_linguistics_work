14.3 探索性因子分析
EFA的目标是通过发掘隐藏在数据下的一组较少的、更为基本的无法观测的变量，来解释一组可观测变量的相关性。
这些虚拟的、无法观测的变量称作因子。
（每个因子被认为可解释多个观测变量间共有的方差，因此准确来说，它们应该称作公共因子。）
模型的形式为：
其中Xi是第i个可观测变量（i = 1...k），Fj是公共因子（j = 1...p），并且p&lt;k。Ui是Xi变量独有的部分（无法被公共因子解释）。
ai可认为是每个因子对复合而成的可观测变量的贡献值。
回到本章开头的Harman74.cor的例子，我们认为每个个体在24个心理学测验上的观测得分，是根据四个潜在心理学因素的加权能力值组合而成。
虽然PCA和EFA存在差异，但是它们的许多分析步骤都是相似的。
为阐述EFA的分析过程，我们用它来对六个心理学测验间的相关性进行分析。 
112个人参与了六个测验，包括非语言的普通智力测验（general）、画图测验（picture）、积木图案测验（blocks）、迷津测验（maze）、阅读测验（reading）和词汇测验（vocab）。
我们如何用一组较少的、潜在的心理学因素来解释参与者的测验得分呢？
数据集ability.cov提供了变量的协方差矩阵，你可用cov2cor()函数将其转化为相关系数矩阵。
数据集没有缺失值。
因为要寻求用来解释数据的潜在结构，可使用EFA方法。
与使用PCA相同，下一步工作为判断需要提取几个因子。
判断需提取的公共因子数
用fa.parallel()函数可判断需提取的因子数：
结果见图14-4。
注意，代码中使用了fa = "both"，因子图形将会同时展示主成分和公共因子分析的结果。
图形中有几个值得注意的地方。
如果使用PCA方法，你可能会选择一个成分（碎石检验和平行分析）或者两个成分（特征值大于1）。
当摇摆不定时，高估因子数通常比低估因子数的结果好，因为高估因子数一般较少曲解“真实”情况。
观察EFA的结果，显然需提取两个因子。
碎石检验的前两个特征值（三角形）都在拐角处之上，并且大于基于100次模拟数据矩阵的特征值均值。
对于EFA， Kaiser-Harris准则的特征值数大于0，而不是1。
（大部分人都没有意识到这一点。）
图形中该准则也建议选择两个因子。
提取公共因子
现在你决定提取两个因子，可以使用fa()函数获得相应的结果。
fa()函数的格式如下：
其中：r是相关系数矩阵或者原始数据矩阵； 
nfactors设定提取的因子数（默认为1）； 
n.obs是观测数（输入相关系数矩阵时需要填写）； 
rotate设定旋转的方法（默认互变异数最小法）； 
scores设定是否计算因子得分（默认不计算）； 
fm设定因子化方法（默认极小残差法）。
与PCA不同，提取公共因子的方法很多，包括最大似然法（ ml）、主轴迭代法（ pa）、加权最小二乘法（ wls）、广义加权最小二乘法（ gls）和最小残差法（ minres）。
统计学家青睐使用最大似然法，因为它有良好的统计性质。
不过有时候最大似然法不会收敛，此时使用主轴迭代法效果会很好。
欲了解更多提取公共因子的方法，可参阅Mulaik（2009）和Corsuch（1983）。
本例使用主轴迭代法（ fm = "pa"）提取未旋转的因子。
结果见代码清单14-6。
可以看到，两个因子解释了六个心理学测验60%的方差。
不过因子载荷阵的意义并不太好解释，此时使用因子旋转将有助于因子的解释。
因子旋转
你可以使用正交旋转或者斜交旋转来旋转14.3.4节中两个因子的结果。
现在我们同时尝试下两种方法，看看它们的异同。
首先使用正交旋转（见代码清单14-7）。
结果显示因子变得更好解释了。
阅读和词汇在第一因子上载荷较大，画图、积木图案和迷宫在第二因子上载荷较大，非语言的普通智力测量在两个因子上载荷较为平均，这表明存在一个语言智力因子和一个非语言智力因子。
使用正交旋转将人为地强制两个因子不相关。
如果想允许两个因子相关该怎么办呢？
此时可以使用斜交转轴法，比如promax（见代码清单14-8）。
根据以上结果，你可以看出正交旋转和斜交旋转的不同之处。
对于正交旋转，因子分析的重点在于因子结构矩阵（变量与因子的相关系数），而对于斜交旋转，因子分析会考虑三个矩阵：因子结构矩阵、因子模式矩阵和因子关联矩阵。 
因子模式矩阵即标准化的回归系数矩阵。
它列出了因子预测变量的权重。
因子关联矩阵即因子相关系数矩阵。
在代码清单14-8中， PA1和PA2栏中的值组成了因子模式矩阵。
它们是标准化的回归系数，而不是相关系数。
注意，矩阵的列仍用来对因子进行命名（虽然此处存在一些争论）。
你同样可以得到一个语言因子和一个非语言因子。
因子关联矩阵显示两个因子的相关系数为0.57，相关性很大。
如果因子间的关联性很低，你可能需要重新使用正交旋转来简化问题。 
因子结构矩阵（或称因子载荷阵）没有被列出来，但你可以使用公式F = P*Phi很轻松地得到它，其中F是因子载荷阵， P为因子模式矩阵， Phi为因子关联矩阵。
下面的函数即可进行该乘法运算：
对上面的例子使用该函数，可得：
现在你可以看到变量与因子间的相关系数。
将它们与正交旋转所得因子载荷阵相比，你会发现该载荷阵列的噪音比较大，这是因为之前你允许潜在因子相关。
虽然斜交方法更为复杂，但模型将更符合真实数据。 
使用factor.plot()或fa.diagram()函数，你可以绘制正交或者斜交结果的图形。
来看以下代码：它的生成图形见图14-5。 
代码：生成的图形见图14-6。
若使simple = TRUE，那么将仅显示每个因子下最大的载荷，以及因子间的相关系数。
这类图形在有多个因子时十分实用。 
当处理真实生活中的数据时，你不可能只对这么少的变量进行因子分析。
此处只是为了操作方便，如果你想检测自己的能力，可尝试对Harman74.cor中的24个心理学测验进行因子分析。
以下代码：应该是个不错的开头。
14.3.4 因子得分
相比PCA，EFA并不那么关注计算因子得分。
在fa()函数中添加score = TRUE选项（原始数据可得时）便可很轻松地获得因子得分。
另外还可以得到得分系数（标准化的回归权重），它在返回对象的weights元素中。 
对于ability.cov数据集，通过二因子斜交旋转法便可获得用来计算因子得分的权重： 
与可精确计算的主成分得分不同，因子得分只是估计得到的。
它的估计方法有多种，fa()函数使用的是回归方法。
若想更多地了解因子得分，可参阅DiStefano、Zhu和Mindrila的“Understanding and Using Factor Scores: Considerations for the Applied Researcher”（2009）。
在继续下文之前，让我们简单了解下其他用于探索性因子分析的实用R软件包。
R包含了其他许多对因子分析非常有用的软件包。
FactoMineR包不仅提供了PCA和EFA方法，还包含潜变量模型。
它有许多此处我们并没考虑的参数选项，比如数值型变量和类别型变量的使用方法。
FAiR包使用遗传算法来估计因子分析模型，它增强了模型参数估计能力，能够处理不等式的约束条件，GPArotation包则提供了许多因子旋转方法。
最后，还有nFactors包，它提供了用来判断因子数目的许多复杂方法。 
EFA只是统计中一种应用广泛的潜变量模型。
在结束本章之前，我们简要看看R中其他的潜变量模型，包括检验先验知识的模型、处理混合数据类型（数值型和类别型）的模型，以及仅基于类别型多因素表的模型。 
在EFA中，你可以用数据来判断需要提取的因子数以及它们的含义。
但是你也可以先从一些先验知识开始，比如变量背后有几个因子、变量在因子上的载荷是怎样的、因子间的相关性如何，然后通过收集数据检验这些先验知识。
这种方法称作验证性因子分析（CFA）。 
CFA是结构方程模型（SEM）中的一种方法。
SEM不仅可以假定潜在因子的数目以及组成，还能假定因子间的影响方式。
你可以将SEM看做是验证性因子分析（对变量）和回归分析（对因子）的组合，它的结果输出包含统计检验和拟合度的指标。
R中有几个可做CFA和SEM的非常优秀的软件包，如sem、openMx和lavaan。
ltm包可以用来拟合测验和问卷中各项目的潜变量模型。
该方法常用来创建大规模标准化测试，比如学术能力测验（SAT）和美国研究生入学考试（GRE）。 
潜类别模型（潜在的因子被认为是类别型而非连续型）可通过FlexMix、lcmm、randomLCA和poLC包进行拟合。
lcda包可做潜类别判别分析，而lsa可做潜在语义分析――一种自然语言处理中的方法。
ca包提供了可做简单和多重对应分析的函数。
利用这些函数，可以分别在二维列联表和多维列联表中探索类别型变量的结构。
最后，R中还包含了众多的多维标度法（MDS）计算工具。
所谓MDS，即可用来发现解释相似性和可测对象（如国家）间距离的潜在维度。
基础安装中的cmdscale()函数可做经典的MDS，而MASS包中的isoMDS()函数可做非线性MDS。
vagan包则包含了可做两种MDS的函数。
本章，我们主要学习了主成分分析（PCA）和探索性因子分析（EFA）两种方法。
PCA在数据降维方面非常有用，它能用一组较少的不相关变量来替代大量相关变量，进而简化分析过程。
EFA包含很多方法，可用来发现一组可观测变量背后潜在的或无法观测的结构（因子）。